<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | AlgoTrade Pro</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <link rel="stylesheet" href="main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body data-theme="light">
    <div class="container">
        <!-- Navigation Bar -->
        <nav class="navbar">
            <div class="nav-left">
                <span class="brand">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                        <path d="M21 21H4.6C4.03995 21 3.75992 21 3.54601 20.891C3.35785 20.7951 3.20487 20.6422 3.10899 20.454C3 20.2401 3 19.9601 3 19.4V3M7 10.5L12 6L15 9L21 3.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    AlgoTrade <span class="pro-badge">PRO</span>
                </span>
            </div>

            <div class="menu-toggle" onclick="toggleMenu()">☰</div>

            <div class="nav-right" id="navMenu">
                <span class="user-greeting">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 5px;">
                        <path d="M20 21C20 19.6044 20 18.9067 19.8278 18.3389C19.44 17.0605 18.4395 16.06 17.1611 15.6722C16.5933 15.5 15.8956 15.5 14.5 15.5H9.5C8.10444 15.5 7.40665 15.5 6.83886 15.6722C5.56045 16.06 4.56004 17.0605 4.17224 18.3389C4 18.9067 4 19.6044 4 21M16.5 7.5C16.5 9.98528 14.4853 12 12 12C9.51472 12 7.5 9.98528 7.5 7.5C7.5 5.01472 9.51472 3 12 3C14.4853 3 16.5 5.01472 16.5 7.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Hello, <strong id="userName"></strong>!
                </span>
                
                <label class="theme-switch" title="Toggle Dark Mode">
                    <input type="checkbox" id="themeCheckbox" onchange="toggleThemeSwitch(this)">
                    <span class="slider"></span>
                </label>

                <button class="logout-btn" onclick="logout()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 5px;">
                        <path d="M16 17L21 12M21 12L16 7M21 12H9M9 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Logout
                </button>
            </div>
        </nav>

        <!-- API Status Banner -->
        <div id="apiStatus" class="api-status" style="display: none;"></div>

        <!-- Market Overview Ticker -->
        <div class="market-overview-container">
            <h3 class="section-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Market Overview
            </h3>
            <div id="marketOverview" class="market-overview"></div>
        </div>

        <!-- Strategy Info -->
        <div class="strategy-info">
            <div class="strategy-header">
                <h3>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                        <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5M12 12H15M12 16H15M9 12H9.01M9 16H9.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Strategy: Moving Average Crossover with RSI Filter
                </h3>
                <span class="strategy-badge">ACTIVE</span>
            </div>
            <p>Real-time algorithmic trading using dual moving average crossover combined with RSI filtering. 
            Buy signals when fast MA crosses above slow MA with RSI < 70. Sell signals when fast MA crosses below slow MA with RSI > 30. 
            Powered by live market data from multiple sources.</p>
        </div>

        <!-- Trading Controls -->
        <div class="controls-section">
            <h3 class="section-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M12 6V12L16 14M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Strategy Parameters
            </h3>
            
            <div class="controls">
                <div class="control-group">
                    <label for="market">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 5px;">
                            <path d="M21 12C21 16.9706 16.9706 21 12 21M21 12C21 7.02944 16.9706 3 12 3M21 12H3M12 21C7.02944 21 3 16.9706 3 12M12 21C13.6569 21 15 16.9706 15 12C15 7.02944 13.6569 3 12 3M12 21C10.3431 21 9 16.9706 9 12C9 7.02944 10.3431 3 12 3M3 12C3 7.02944 7.02944 3 12 3" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Market Pair
                    </label>
    <select id="market">
        <!-- Forex Pairs -->
        <optgroup label="Forex Major Pairs">
            <option value="EUR/USD">EUR/USD</option>
            <option value="GBP/USD">GBP/USD</option>
            <option value="USD/JPY">USD/JPY</option>
            <option value="USD/CHF">USD/CHF</option>
            <option value="AUD/USD">AUD/USD</option>
            <option value="NZD/USD">NZD/USD</option>
            <option value="USD/CAD">USD/CAD</option>
        </optgroup>
        
        <optgroup label="Forex Minor Pairs">
            <option value="EUR/GBP">EUR/GBP</option>
            <option value="EUR/JPY">EUR/JPY</option>
            <option value="GBP/JPY">GBP/JPY</option>
            <option value="EUR/AUD">EUR/AUD</option>
            <option value="GBP/AUD">GBP/AUD</option>
        </optgroup>
        
        <!-- Cryptocurrency Pairs -->
        <optgroup label="Cryptocurrency">
            <option value="BTC/USD">BTC/USD (Bitcoin)</option>
            <option value="ETH/USD">ETH/USD (Ethereum)</option>
            <option value="SOL/USD">SOL/USD (Solana)</option>
            <option value="XRP/USD">XRP/USD (Ripple)</option>
            <option value="ADA/USD">ADA/USD (Cardano)</option>
            <option value="DOGE/USD">DOGE/USD (Dogecoin)</option>
            <option value="DOT/USD">DOT/USD (Polkadot)</option>
            <option value="BNB/USD">BNB/USD (Binance Coin)</option>
            <option value="LTC/USD">LTC/USD (Litecoin)</option>
            <option value="AVAX/USD">AVAX/USD (Avalanche)</option>
        </optgroup>
        
        <!-- Commodities & Metals -->
        <optgroup label="Commodities & Metals">
            <option value="XAU/USD">XAU/USD (Gold)</option>
            <option value="XAG/USD">XAG/USD (Silver)</option>
            <option value="XPT/USD">XPT/USD (Platinum)</option>
            <option value="XPD/USD">XPD/USD (Palladium)</option>
            <option value="USO/USD">USO/USD (Crude Oil)</option>
            <option value="NGAS/USD">NGAS/USD (Natural Gas)</option>
        </optgroup>
        
        <!-- Indices & Stocks -->
        <optgroup label="Indices & Stocks">
            <option value="SPX/USD">SPX/USD (S&P 500)</option>
            <option value="NDX/USD">NDX/USD (Nasdaq 100)</option>
            <option value="DJI/USD">DJI/USD (Dow Jones)</option>
            <option value="FTSE/GBP">FTSE/GBP (FTSE 100)</option>
            <option value="DAX/EUR">DAX/EUR (DAX 40)</option>
        </optgroup>
    </select>
                </div>

                <div class="control-group">
                    <label for="fastMA">Fast MA Period</label>
                    <input type="number" id="fastMA" value="10" min="5" max="50">
                    <span class="input-hint">5-50 days</span>
                </div>

                <div class="control-group">
                    <label for="slowMA">Slow MA Period</label>
                    <input type="number" id="slowMA" value="30" min="20" max="100">
                    <span class="input-hint">20-100 days</span>
                </div>

                <div class="control-group">
                    <label for="rsiPeriod">RSI Period</label>
                    <input type="number" id="rsiPeriod" value="14" min="10" max="30">
                    <span class="input-hint">10-30 days</span>
                </div>

                <div class="control-group">
                    <label for="initialCapital">Initial Capital</label>
                    <input type="number" id="initialCapital" value="10000" min="1000" step="1000">
                    <span class="input-hint">Min: $1,000</span>
                </div>

                <div class="control-group">
                    <label for="positionSize">Position Size</label>
                    <input type="number" id="positionSize" value="10" min="1" max="100">
                    <span class="input-hint">1-100%</span>
                </div>
            </div>

            <button id="runBacktest" onclick="runBacktest()" class="run-backtest-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M5 3L19 12L5 21V3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="currentColor"/>
                </svg>
                Run Backtest with Live Data
            </button>
        </div>

        <div id="loading" class="loading" style="display: none;">
            <div class="loading-spinner"></div>
            <p>Fetching real-time market data and running backtest...</p>
        </div>

        <!-- Dashboard Metrics -->
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h2>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M22 12H18L15 21L9 3L6 12H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Performance Metrics
                    </h2>
                </div>
                <div id="performanceMetrics"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M16 8V16M12 11V16M8 14V16M6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Trade Statistics
                    </h2>
                </div>
                <div id="tradeStats"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Current Signal
                    </h2>
                    <span class="live-indicator">● LIVE</span>
                </div>
                <div id="currentSignal"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Risk Metrics
                    </h2>
                </div>
                <div id="riskMetrics"></div>
            </div>
        </div>

        <!-- Charts -->
        <div class="chart-container">
            <h2 style="color: var(--accent-primary); margin-bottom: 20px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M3 13L8 8L12 12L21 3M21 3H16M21 3V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Price Action & Trading Signals
            </h2>
            <div id="priceChart"></div>
        </div>

        <div class="chart-container">
            <h2 style="color: var(--accent-primary); margin-bottom: 20px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M13 7H7V13H13V7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21 11V17H15V11H21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M13 17V21H7V17H13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21 3V7H15V3H21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Portfolio Equity Curve
            </h2>
            <div id="equityChart"></div>
        </div>

        <div class="chart-container">
            <h2 style="color: var(--accent-primary); margin-bottom: 20px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: middle; margin-right: 8px;">
                    <path d="M16 8V16M12 11V16M8 14V16M6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Technical Indicators (RSI)
            </h2>
            <div id="indicatorChart"></div>
        </div>
    </div>
    
    <!-- Load API Service first -->
    <script src="api-service.js"></script>
    <!-- Then load main app -->
    <script src="main.js"></script>
</body>
</html>